## Purpose:

Program performs [Lanczos diagonalization](https://en.wikipedia.org/wiki/Lanczos_algorithm) with reorthogonalization of a 100X100 matrix.
Uses MPI-IO to write and read Lanczos vectors to disk at each iteration.

### Contents:

* <code>planczos2.f90</code>: Fortran source code
* <code>external_libs.f90</code>: Subroutines needed by main program
* <code>Makefile</code>: Makefile to compile the source code
* <code>run.sbatch</code>: Btach-job submission script to send the job to the queue.


### Example Makefile:

```bash
#==========================================================
# Make file
#==========================================================
F90CFLAGS   = -c -O2
F90COMPILER = mpif90
PRO         = planczos
OBJECTS     = planczos2.o \
              external_libs.o

${PRO}.x : $(OBJECTS)
	$(F90COMPILER) -o ${PRO}.x $(OBJECTS)

%.o : %.f90
	$(F90COMPILER) $(F90CFLAGS) $(<F)

clean : 
	rm -f *.o *.x *.mod *.lvec *.out *.err
```

### Example Batch-Job Submission Script:

```bash
#!/bin/bash
#SBATCH -J planczos
#SBATCH -o planczos.out
#SBATCH -e planczos.err
#SBATCH -p test
#SBATCH -t 30
#SBATCH -n 8
#SBATCH --mem-per-cpu=4000

# Load required modules
module load intel/24.0.1-fasrc01 openmpi/5.0.2-fasrc01

# Run program
srun -n $SLURM_NTASKS --mpi=pmix ./planczos.x
```

### Example usage:

```bash
module load intel/24.0.1-fasrc01 openmpi/5.0.2-fasrc01
make
sbatch run.sbatch
```

### Example Output:

```bash
> cat planczos.out
           5  lowest eigenvalues - Lanczos, exact
 iteration:           1
           1   49.8653454477317        50.0109460873557     
           2  0.000000000000000E+000   5.19875053092609     
           3  0.000000000000000E+000   5.18567834116605     
           4  0.000000000000000E+000   5.00141432508220     
           5  0.000000000000000E+000   4.80328316503722     
           5  lowest eigenvalues - Lanczos, exact
 iteration:           2
           1   50.0104835368772        50.0109460873557     
           2  0.000000000000000E+000   5.19875053092609     
           3  0.000000000000000E+000   5.18567834116605     
           4  0.000000000000000E+000   5.00141432508220     
           5  0.000000000000000E+000   4.80328316503722     
           5  lowest eigenvalues - Lanczos, exact
 iteration:           3
           1   50.0109441147907        50.0109460873557     
           2   2.23815199991312        5.19875053092609     
           3  0.000000000000000E+000   5.18567834116605     
           4  0.000000000000000E+000   5.00141432508220     
           5  0.000000000000000E+000   4.80328316503722     
           5  lowest eigenvalues - Lanczos, exact
 iteration:           4
           1   50.0109460798944        50.0109460873557     
           2   3.69448411485851        5.19875053092609     
           3  0.000000000000000E+000   5.18567834116605     
           4  0.000000000000000E+000   5.00141432508220     
           5  0.000000000000000E+000   4.80328316503722     
           5  lowest eigenvalues - Lanczos, exact
 iteration:           5
           1   50.0109460873355        50.0109460873557     
           2   4.56239706522496        5.19875053092609     
           3   1.50663754167888        5.18567834116605     
           4  0.000000000000000E+000   5.00141432508220     
           5  0.000000000000000E+000   4.80328316503722     
           5  lowest eigenvalues - Lanczos, exact
 iteration:           6
           1   50.0109460873557        50.0109460873557     
           2   4.87805574390008        5.19875053092609     
           3   2.32859803786566        5.18567834116605     
           4  0.000000000000000E+000   5.00141432508220     
           5  0.000000000000000E+000   4.80328316503722     
           5  lowest eigenvalues - Lanczos, exact
 iteration:           7
           1   50.0109460873557        50.0109460873557     
           2   5.04329670834898        5.19875053092609     
           3   3.17170805673258        5.18567834116605     
           4   1.16947497197068        5.00141432508220     
           5  0.000000000000000E+000   4.80328316503722     
           5  lowest eigenvalues - Lanczos, exact
 iteration:           8
           1   50.0109460873557        50.0109460873557     
           2   5.14059321409184        5.19875053092609     
           3   3.77648989749052        5.18567834116605     
           4   1.81438290322595        5.00141432508220     
           5  0.000000000000000E+000   4.80328316503722     
           5  lowest eigenvalues - Lanczos, exact
 iteration:           9
           1   50.0109460873557        50.0109460873557     
           2   5.16808236235309        5.19875053092609     
           3   3.96384005925381        5.18567834116605     
           4   2.11236591397106        5.00141432508220     
           5  0.548453103477585        4.80328316503722     
           5  lowest eigenvalues - Lanczos, exact
 iteration:          10
           1   50.0109460873557        50.0109460873557     
           2   5.17891051650270        5.19875053092609     
           3   4.08708241666490        5.18567834116605     
           4   2.71654501370494        5.00141432508220     
           5   1.58775698936468        4.80328316503722     
           5  lowest eigenvalues - Lanczos, exact
 iteration:          11
           1   50.0109460873557        50.0109460873557     
           2   5.18408766488655        5.19875053092609     
           3   4.21955735915442        5.18567834116605     
           4   3.38628187911401        5.00141432508220     
           5   1.93601025459830        4.80328316503722     
           5  lowest eigenvalues - Lanczos, exact
 iteration:          12
           1   50.0109460873557        50.0109460873557     
           2   5.18713756497067        5.19875053092609     
           3   4.38358689430100        5.18567834116605     
           4   3.72961505300335        5.00141432508220     
           5   2.18601731107472        4.80328316503722     
           5  lowest eigenvalues - Lanczos, exact
 iteration:          13
           1   50.0109460873557        50.0109460873557     
           2   5.19001250939843        5.19875053092609     
           3   4.60941265284947        5.18567834116605     
           4   3.93556130971288        5.00141432508220     
           5   2.70890136650200        4.80328316503722     
           5  lowest eigenvalues - Lanczos, exact
 iteration:          14
           1   50.0109460873557        50.0109460873557     
           2   5.19207925039225        5.19875053092609     
           3   4.75840991095126        5.18567834116605     
           4   4.02694460222600        5.00141432508220     
           5   3.08952462540097        4.80328316503722     
           5  lowest eigenvalues - Lanczos, exact
 iteration:          15
           1   50.0109460873557        50.0109460873557     
           2   5.19349298769301        5.19875053092609     
           3   4.84517919966478        5.18567834116605     
           4   4.09197158158115        5.00141432508220     
           5   3.39455485971742        4.80328316503722     
           5  lowest eigenvalues - Lanczos, exact
 iteration:          16
           1   50.0109460873557        50.0109460873557     
           2   5.19421139517351        5.19875053092609     
           3   4.88688085483899        5.18567834116605     
           4   4.14626471168753        5.00141432508220     
           5   3.61783564621040        4.80328316503722     
           5  lowest eigenvalues - Lanczos, exact
 iteration:          17
           1   50.0109460873557        50.0109460873557     
           2   5.19466140597224        5.19875053092609     
           3   4.91495721878221        5.18567834116605     
           4   4.22680209330934        5.00141432508220     
           5   3.82972455687359        4.80328316503722     
           5  lowest eigenvalues - Lanczos, exact
 iteration:          18
           1   50.0109460873557        50.0109460873557     
           2   5.19501852190973        5.19875053092609     
           3   4.94145273450612        5.18567834116605     
           4   4.39104150290958        5.00141432508220     
           5   3.99704951468348        4.80328316503722     
           5  lowest eigenvalues - Lanczos, exact
 iteration:          19
           1   50.0109460873557        50.0109460873557     
           2   5.19530641751534        5.19875053092609     
           3   4.96777132705340        5.18567834116605     
           4   4.56138221700448        5.00141432508220     
           5   4.06805513337751        4.80328316503722     
           5  lowest eigenvalues - Lanczos, exact
 iteration:          20
           1   50.0109460873557        50.0109460873557     
           2   5.19554191161180        5.19875053092609     
           3   4.99379440231424        5.18567834116605     
           4   4.67681174846301        5.00141432508220     
           5   4.10980107066655        4.80328316503722     
           5  lowest eigenvalues - Lanczos, exact
 iteration:          21
           1   50.0109460873557        50.0109460873557     
           2   5.19567196358898        5.19875053092609     
           3   5.01024389068775        5.18567834116605     
           4   4.72995309862831        5.00141432508220     
           5   4.13945468555465        4.80328316503722     
           5  lowest eigenvalues - Lanczos, exact
 iteration:          22
           1   50.0109460873557        50.0109460873557     
           2   5.19574802143632        5.19875053092609     
           3   5.02112586940889        5.18567834116605     
           4   4.76172795124141        5.00141432508220     
           5   4.17802463845432        4.80328316503722     
           5  lowest eigenvalues - Lanczos, exact
 iteration:          23
           1   50.0109460873557        50.0109460873557     
           2   5.19581551250249        5.19875053092609     
           3   5.03269566372562        5.18567834116605     
           4   4.79744023937458        5.00141432508220     
           5   4.31478617841068        4.80328316503722     
           5  lowest eigenvalues - Lanczos, exact
 iteration:          24
           1   50.0109460873557        50.0109460873557     
           2   5.19590783549696        5.19875053092609     
           3   5.05320700575411        5.18567834116605     
           4   4.86166065472269        5.00141432508220     
           5   4.55240825842296        4.80328316503722     
           5  lowest eigenvalues - Lanczos, exact
 iteration:          25
           1   50.0109460873557        50.0109460873557     
           2   5.19603475088105        5.19875053092609     
           3   5.08572960095133        5.18567834116605     
           4   4.92576977911138        5.00141432508220     
           5   4.65120378245167        4.80328316503722     
           5  lowest eigenvalues - Lanczos, exact
 iteration:          26
           1   50.0109460873557        50.0109460873557     
           2   5.19618716551327        5.19875053092609     
           3   5.11652479930101        5.18567834116605     
           4   4.95665872463443        5.00141432508220     
           5   4.68628865169380        4.80328316503722     
           5  lowest eigenvalues - Lanczos, exact
 iteration:          27
           1   50.0109460873557        50.0109460873557     
           2   5.19639091649177        5.19875053092609     
           3   5.14100530086637        5.18567834116605     
           4   4.97286958283142        5.00141432508220     
           5   4.70771111282187        4.80328316503722     
           5  lowest eigenvalues - Lanczos, exact
 iteration:          28
           1   50.0109460873557        50.0109460873557     
           2   5.19669530038893        5.19875053092609     
           3   5.15956307125968        5.18567834116605     
           4   4.98333366538709        5.00141432508220     
           5   4.72676730695102        4.80328316503722     
           5  lowest eigenvalues - Lanczos, exact
 iteration:          29
           1   50.0109460873557        50.0109460873557     
           2   5.19721117087156        5.19875053092609     
           3   5.17336820525746        5.18567834116605     
           4   4.99137062182572        5.00141432508220     
           5   4.74904309520265        4.80328316503722     
           5  lowest eigenvalues - Lanczos, exact
 iteration:          30
           1   50.0109460873557        50.0109460873557     
           2   5.19787823298590        5.19875053092609     
           3   5.18099332466817        5.18567834116605     
           4   4.99665949340460        5.00141432508220     
           5   4.77092012954853        4.80328316503722     
           5  lowest eigenvalues - Lanczos, exact
 iteration:          31
           1   50.0109460873557        50.0109460873557     
           2   5.19839212127051        5.19875053092609     
           3   5.18413705536980        5.18567834116605     
           4   4.99945384420387        5.00141432508220     
           5   4.78634396981202        4.80328316503722     
           5  lowest eigenvalues - Lanczos, exact
 iteration:          32
           1   50.0109460873557        50.0109460873557     
           2   5.19862284465351        5.19875053092609     
           3   5.18517067842760        5.18567834116605     
           4   5.00061653068442        5.00141432508220     
           5   4.79429633567640        4.80328316503722     
           5  lowest eigenvalues - Lanczos, exact
 iteration:          33
           1   50.0109460873557        50.0109460873557     
           2   5.19869209568210        5.19875053092609     
           3   5.18544968087534        5.18567834116605     
           4   5.00099192941118        5.00141432508220     
           5   4.79736037443140        4.80328316503722     
           5  lowest eigenvalues - Lanczos, exact
 iteration:          34
           1   50.0109460873557        50.0109460873557     
           2   5.19872837012742        5.19875053092609     
           3   5.18559175162724        5.18567834116605     
           4   5.00122014076404        5.00141432508220     
           5   4.79965091419304        4.80328316503722     
           5  lowest eigenvalues - Lanczos, exact
 iteration:          35
           1   50.0109460873557        50.0109460873557     
           2   5.19874295561081        5.19875053092609     
           3   5.18564850875464        5.18567834116605     
           4   5.00133118697899        5.00141432508220     
           5   4.80108521324420        4.80328316503722     
           5  lowest eigenvalues - Lanczos, exact
 iteration:          36
           1   50.0109460873557        50.0109460873557     
           2   5.19874720272542        5.19875053092609     
           3   5.18566509958123        5.18567834116605     
           4   5.00136973233312        5.00141432508220     
           5   4.80171207836641        4.80328316503722     
           5  lowest eigenvalues - Lanczos, exact
 iteration:          37
           1   50.0109460873557        50.0109460873557     
           2   5.19874893025227        5.19875053092609     
           3   5.18567190372623        5.18567834116605     
           4   5.00138834741648        5.00141432508220     
           5   4.80208997085672        4.80328316503722     
           5  lowest eigenvalues - Lanczos, exact
 iteration:          38
           1   50.0109460873557        50.0109460873557     
           2   5.19874981237612        5.19875053092609     
           3   5.18567541662809        5.18567834116605     
           4   5.00139996097122        5.00141432508220     
           5   4.80239797226433        4.80328316503722     
           5  lowest eigenvalues - Lanczos, exact
 iteration:          39
           1   50.0109460873557        50.0109460873557     
           2   5.19875024848515        5.19875053092609     
           3   5.18567717623090        5.18567834116605     
           4   5.00140720158571        5.00141432508220     
           5   4.80266556939511        4.80328316503722     
           5  lowest eigenvalues - Lanczos, exact
 iteration:          40
           1   50.0109460873557        50.0109460873557     
           2   5.19875042629451        5.19875053092609     
           3   5.18567790323908        5.18567834116605     
           4   5.00141093362649        5.00141432508220     
           5   4.80286291824518        4.80328316503722     
           5  lowest eigenvalues - Lanczos, exact
 iteration:          41
           1   50.0109460873557        50.0109460873557     
           2   5.19875047734536        5.19875053092609     
           3   5.18567811452029        5.18567834116605     
           4   5.00141225580541        5.00141432508220     
           5   4.80295924013067        4.80328316503722     
           5  lowest eigenvalues - Lanczos, exact
 iteration:          42
           1   50.0109460873557        50.0109460873557     
           2   5.19875050829270        5.19875053092609     
           3   5.18567824433658        5.18567834116605     
           4   5.00141326620172        5.00141432508220     
           5   4.80306415706393        4.80328316503722     
           5  lowest eigenvalues - Lanczos, exact
 iteration:          43
           1   50.0109460873557        50.0109460873557     
           2   5.19875052558121        5.19875053092609     
           3   5.18567831800515        5.18567834116605     
           4   5.00141401217870        5.00141432508220     
           5   4.80318944956560        4.80328316503722     
           5  lowest eigenvalues - Lanczos, exact
 iteration:          44
           1   50.0109460873557        50.0109460873557     
           2   5.19875052941551        5.19875053092609     
           3   5.18567833455145        5.18567834116605     
           4   5.00141421955277        5.00141432508220     
           5   4.80324206078848        4.80328316503722     
           5  lowest eigenvalues - Lanczos, exact
 iteration:          45
           1   50.0109460873557        50.0109460873557     
           2   5.19875053036714        5.19875053092609     
           3   5.18567833869478        5.18567834116605     
           4   5.00141427940113        5.00141432508220     
           5   4.80326139645537        4.80328316503722     
           5  lowest eigenvalues - Lanczos, exact
 iteration:          46
           1   50.0109460873557        50.0109460873557     
           2   5.19875053072174        5.19875053092609     
           3   5.18567834025394        5.18567834116605     
           4   5.00141430559019        5.00141432508220     
           5   4.80327190971934        4.80328316503722     
           5  lowest eigenvalues - Lanczos, exact
 iteration:          47
           1   50.0109460873557        50.0109460873557     
           2   5.19875053086185        5.19875053092609     
           3   5.18567834087658        5.18567834116605     
           4   5.00141431791982        5.00141432508220     
           5   4.80327814262483        4.80328316503722     
           5  lowest eigenvalues - Lanczos, exact
 iteration:          48
           1   50.0109460873557        50.0109460873557     
           2   5.19875053090882        5.19875053092609     
           3   5.18567834108751        5.18567834116605     
           4   5.00141432283722        5.00141432508220     
           5   4.80328126414163        4.80328316503722     
           5  lowest eigenvalues - Lanczos, exact
 iteration:          49
           1   50.0109460873557        50.0109460873557     
           2   5.19875053092219        5.19875053092609     
           3   5.18567834114816        5.18567834116605     
           4   5.00141432449576        5.00141432508220     
           5   4.80328257187636        4.80328316503722     
           5  lowest eigenvalues - Lanczos, exact
 iteration:          50
           1   50.0109460873557        50.0109460873557     
           2   5.19875053092516        5.19875053092609     
           3   5.18567834116181        5.18567834116605     
           4   5.00141432492570        5.00141432508220     
           5   4.80328297967488        4.80328316503722     
 Lanczos iterations finished...
```
