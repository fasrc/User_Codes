### Purpose:

Numerical computation of derivatives of a function is an important and frequent task in science and engineering. In some cases the values of the function are known only as data points at specific locations on the abscissa. This scenario arises frequently in empirical and numeric experiments where the ordinate values are derived from measurements or simulations and there is no (known) analytic expression describing the function.

The specific example uses a 3-point Lagrangian interpolation to compute numerically the first derivative of *sin(x)*, in the interval [0, PI], and compares the result with the exact derivative, *cos(x)*.

### Contents:

* <code>deriv\_tab.f90</code>: Function to compute first or second derivative of a tabulated function using 3-point Lagrangian interpolation
* <code>deriv\_test.f90</code>: Fortran source code - driver for <code>deriv\_tab.f90</code>

### Compile:

**Intel Fortran Compiler (ifort):** 

```bash
ifort -o deriv_test.x deriv_tab.f90 deriv_test.f90 -O2
```

**GNU Fortran Compiler (gfortran):** 

```bash
gfortran -o deriv_test.x deriv_tab.f90 deriv_test.f90 -O2
```

### Example Output:

```
[pkrastev@sa01 Deriv]$ ./deriv_test.x 
        x           y         dy/dx       Exact
    0.000000    0.000000    1.000336    1.000000
    0.031733    0.031728    0.999832    0.999497
    0.063467    0.063424    0.998321    0.997987
    0.095200    0.095056    0.995805    0.995472
    0.126933    0.126592    0.992287    0.991955
    0.158666    0.158001    0.987769    0.987439
    0.190400    0.189251    0.982257    0.981929
    0.222133    0.220311    0.975755    0.975430
    0.253866    0.251148    0.968271    0.967949
    0.285599    0.281733    0.959813    0.959493
    0.317333    0.312033    0.950387    0.950071
    0.349066    0.342020    0.940005    0.939693
    0.380799    0.371662    0.928676    0.928368
    0.412532    0.400931    0.916413    0.916108
    0.444266    0.429795    0.903226    0.902927
    0.475999    0.458227    0.889130    0.888835
    0.507732    0.486197    0.874139    0.873849
    0.539465    0.513677    0.858267    0.857983
    0.571199    0.540641    0.841531    0.841254
    0.602932    0.567060    0.823948    0.823677
    0.634665    0.592908    0.805536    0.805270
    0.666398    0.618159    0.786312    0.786053
    0.698132    0.642788    0.766296    0.766044
    0.729865    0.666769    0.745509    0.745264
    0.761598    0.690079    0.723971    0.723734
    0.793331    0.712694    0.701705    0.701475
    0.825065    0.734592    0.678731    0.678509
    0.856798    0.755750    0.655074    0.654861
    0.888531    0.776146    0.630758    0.630553
    0.920265    0.795762    0.605807    0.605610
    0.951998    0.814576    0.580245    0.580057
    0.983731    0.832570    0.554099    0.553920
    1.015464    0.849725    0.527396    0.527225
    1.047198    0.866025    0.500161    0.500000
    1.078931    0.881453    0.472423    0.472271
    1.110664    0.895994    0.444208    0.444067
    1.142397    0.909632    0.415547    0.415415
    1.174131    0.922354    0.386467    0.386345
    1.205864    0.934148    0.356999    0.356886
    1.237597    0.945001    0.327170    0.327068
    1.269330    0.954902    0.297012    0.296920
    1.301064    0.963842    0.266556    0.266474
    1.332797    0.971812    0.235830    0.235759
    1.364530    0.978802    0.204868    0.204807
    1.396263    0.984808    0.173699    0.173648
    1.427997    0.989821    0.142355    0.142315
    1.459730    0.993838    0.110867    0.110838
    1.491463    0.996855    0.079269    0.079250
    1.523196    0.998867    0.047590    0.047582
    1.554930    0.999874    0.015863    0.015866
    1.586663    0.999874   -0.015879   -0.015866
    1.618396    0.998867   -0.047606   -0.047582
    1.650129    0.996855   -0.079285   -0.079250
    1.681863    0.993838   -0.110883   -0.110838
    1.713596    0.989821   -0.142370   -0.142315
    1.745329    0.984808   -0.173714   -0.173648
    1.777063    0.978802   -0.204883   -0.204807
    1.808796    0.971812   -0.235846   -0.235759
    1.840529    0.963842   -0.266571   -0.266474
    1.872262    0.954902   -0.297028   -0.296920
    1.903996    0.945001   -0.327185   -0.327068
    1.935729    0.934148   -0.357013   -0.356886
    1.967462    0.922354   -0.386482   -0.386345
    1.999195    0.909632   -0.415562   -0.415415
    2.030929    0.895994   -0.444223   -0.444067
    2.062662    0.881453   -0.472437   -0.472271
    2.094395    0.866025   -0.500175   -0.500000
    2.126128    0.849725   -0.527409   -0.527225
    2.157862    0.832570   -0.554113   -0.553920
    2.189595    0.814576   -0.580258   -0.580057
    2.221328    0.795762   -0.605819   -0.605610
    2.253061    0.776146   -0.630770   -0.630553
    2.284795    0.755750   -0.655087   -0.654861
    2.316528    0.734592   -0.678743   -0.678509
    2.348261    0.712694   -0.701716   -0.701475
    2.379994    0.690079   -0.723982   -0.723734
    2.411728    0.666769   -0.745520   -0.745264
    2.443461    0.642788   -0.766307   -0.766044
    2.475194    0.618159   -0.786322   -0.786053
    2.506927    0.592908   -0.805545   -0.805270
    2.538661    0.567060   -0.823957   -0.823677
    2.570394    0.540641   -0.841540   -0.841254
    2.602127    0.513677   -0.858275   -0.857983
    2.633861    0.486197   -0.874146   -0.873849
    2.665594    0.458227   -0.889137   -0.888835
    2.697327    0.429795   -0.903233   -0.902927
    2.729060    0.400931   -0.916419   -0.916108
    2.760794    0.371662   -0.928682   -0.928368
    2.792527    0.342020   -0.940011   -0.939693
    2.824260    0.312033   -0.950392   -0.950071
    2.855993    0.281733   -0.959817   -0.959493
    2.887727    0.251148   -0.968276   -0.967949
    2.919460    0.220311   -0.975759   -0.975430
    2.951193    0.189251   -0.982260   -0.981929
    2.982926    0.158001   -0.987771   -0.987439
    3.014660    0.126592   -0.992289   -0.991955
    3.046393    0.095056   -0.995807   -0.995472
    3.078126    0.063424   -0.998322   -0.997987
    3.109859    0.031728   -0.999329   -0.999497
    3.141593    0.000000   -1.000336   -1.000000
```
